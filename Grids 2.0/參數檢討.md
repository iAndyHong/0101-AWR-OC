# Super Trend 參數檢討

## 一、Grids EA 中 Super Trend 相關變數的邏輯影響

### 1. ST_SignalMode (首單模式)

- **值 0 = SIGNAL_MODE_TREND (順勢)**：趨勢向上開 Buy，趨勢向下開 Sell
- **值 1 = SIGNAL_MODE_REVERSAL (逆勢)**：趨勢向上開 Sell，趨勢向下開 Buy

影響函數：`GetTradeDirectionFromSignal()`、`IsTrendAllowBuy()`、`IsTrendAllowSell()`

### 2. ST_AveragingMode (加倉模式)

- **值 0 = AVERAGING_ANY**：趨勢順向或中性時允許加倉，趨勢翻轉時停止加倉
- **值 1 = AVERAGING_TREND**：只有趨勢明確順向時才允許加倉

影響函數：`ExecuteGridTrading()` 中的 Buy/Sell 加倉邏輯

### 3. PG_TradeDirection (交易方向限制)

- **值 0 = TRADE_BOTH**：允許 Buy 和 Sell 雙向交易
- **值 1 = TRADE_BUY_ONLY**：只允許 Buy，強制覆蓋趨勢過濾
- **值 2 = TRADE_SELL_ONLY**：只允許 Sell，強制覆蓋趨勢過濾

影響函數：`IsTrendAllowBuy()`、`IsTrendAllowSell()`、`ExecuteGridTrading()`

---

## 二、與原廠 00.set 的對應分析

### 原廠變數對照

**STrend_Timeframe = 0** ✅ 已實作
- 對應：`TF_Timeframe = 0`

**AmplitudeSimpleTrend = 4** ❌ 未實作
- 對應：無

**TrendPredictorSignals = 2** ⚠️ 部分對應
- 對應：`ST_SignalMode`（只有 0 和 1）

**AveragingTrPr = 2** ⚠️ 部分對應
- 對應：`ST_AveragingMode`（只有 0 和 1）

### 詳細分析

**1. STrend_Timeframe = 0** ✅ 已實作
- 原廠意義：使用當前圖表時間框架
- Grids EA：`TF_Timeframe = 0` 完全對應

**2. AmplitudeSimpleTrend = 4** ❌ 未實作
- 原廠意義：可能是 AW Trend Predictor 指標的振幅參數，用於調整趨勢敏感度
- Grids EA：目前沒有對應變數，Super Trend 使用 `ST_ATR_Period` 和 `ST_Multiplier` 控制敏感度

**3. TrendPredictorSignals = 2** ⚠️ 部分對應
- 原廠意義（推測）：0=不使用、1=順勢、2=逆勢或其他模式
- Grids EA：`ST_SignalMode` 只有 0 和 1 兩個值，原廠值 2 無法對應

**4. AveragingTrPr = 2** ⚠️ 部分對應
- 原廠意義（推測）：0=不限制、1=順勢加倉、2=其他模式
- Grids EA：`ST_AveragingMode` 只有 0 和 1 兩個值，原廠值 2 無法對應

---

## 三、潛在問題總結

**中等嚴重度：**
- **缺少 AmplitudeSimpleTrend** → 無法調整趨勢敏感度
- **TrendPredictorSignals 值域不完整** → 原廠值為 2，Grids EA 只支援 0 和 1
- **AveragingTrPr 值域不完整** → 原廠值為 2，Grids EA 只支援 0 和 1

**低嚴重度：**
- **Super Trend 算法差異** → 與 AW Trend Predictor 可能有細微差異

---

## 四、建議

1. 研究原廠 AW Trend Predictor 的完整參數，確認值 2 的含義
2. 考慮新增 `AmplitudeSimpleTrend` 對應參數
3. 擴展 `ST_SignalMode` 和 `ST_AveragingMode` 的值域（如果原廠確實有第三種模式）
4. 進行回測比對，確認趨勢信號是否與原廠一致

---

## 五、版本記錄

- **2024-12-14 v1.0** → 初始版本，分析 Super Trend 參數與原廠對應關係
